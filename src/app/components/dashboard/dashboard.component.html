<div class="dashboard-container" *ngIf="!loading && creditReport">
  <div class="dashboard-content">
    <!-- Alerts and Theme Toggle Above Score Changes Section -->
    <div class="theme-toggle-container">
      <app-alerts-button></app-alerts-button>
      <app-theme-toggle></app-theme-toggle>
    </div>
    
    <!-- Combined Score and Changes Section -->
    <section class="score-changes-section">
      <div class="score-changes-container">
        <div class="score-display-area">
          <app-score-display 
            [currentScore]="creditReport.currentScore"
            [previousScore]="creditReport.previousScore">
          </app-score-display>
          <p class="last-updated">Last updated: {{ creditReport.lastUpdated | date:'medium' }}</p>
        </div>
        
        <div class="changes-display-area">
          <app-changes-overview [changes]="creditReport.changes"></app-changes-overview>
        </div>
      </div>
    </section>

    <!-- Score History Chart with Tabs -->
    <section class="chart-section">
      <div class="chart-tabs">
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'history'"
          (click)="setActiveTab('history')">
          Score History
        </button>
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'analysis'"
          (click)="setActiveTab('analysis')">
          Score Review
        </button>
      </div>
      
      <div class="tab-content">
        <div *ngIf="activeTab === 'history'" class="tab-panel">
          <app-score-chart [scoreHistory]="creditReport.scoreHistory"></app-score-chart>
        </div>
        
        <div *ngIf="activeTab === 'analysis'" class="tab-panel">
          <div class="analysis-content">
            <div class="analysis-section">
              <h3 class="analysis-title neutral">ðŸ“Š Pattern Analysis</h3>
              <div class="analysis-text">
                {{ getPatternAnalysis() }}
              </div>
            </div>

            <div class="analysis-section">
              <h3 class="analysis-title positive">âœ“ What's Going Well</h3>
              <div class="analysis-text">
                {{ getPositiveAnalysis() }}
              </div>
            </div>
            
            <div class="analysis-section">
              <h3 class="analysis-title negative">âš  Areas for Improvement</h3>
              <div class="analysis-text">
                {{ getNegativeAnalysis() }}
              </div>
            </div>  
          </div>
        </div>
      </div>
    </section>

    <!-- Action Tiles -->
    <section class="action-tiles-section">
      <app-action-tiles></app-action-tiles>
    </section>

    <!-- Score Ingredients -->
    <section class="ingredients-section">
      <h2>Score Ingredients</h2>
      <app-score-ingredients [ingredients]="creditReport.scoreIngredients"></app-score-ingredients>
    </section>
  </div>
</div>

<div class="loading-container" *ngIf="loading">
  <div class="loading-spinner"></div>
  <p>Loading your credit report...</p>
</div>